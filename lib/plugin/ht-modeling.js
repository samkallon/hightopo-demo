!function(U,E){"use strict";function m(U,m,R){n("ht."+U,m,R)}function u(U,m,R){R?U.push(m.x,m.y):U.push(m.x,m.y,m.z)}function l(F,U,m){var R,A=F.data.getAttaches();if(A&&A.each(function(U){U instanceof q&&U.s("attach.operation")&&(R=R||[]).push(U)}),R){r.forEach(function(U){U=function(U,m,R,A){var d,N,T,j,B=0,E=[];if(A)for(d=A.length;B<d;B+=3)N=A[B],T=A[B+1],j=A[B+2],Z(E,new M([m[3*N],m[3*N+1],m[3*N+2]],null,R?[R[2*N],R[2*N+1],0]:S),new M([m[3*T],m[3*T+1],m[3*T+2]],null,R?[R[2*T],R[2*T+1],0]:S),new M([m[3*j],m[3*j+1],m[3*j+2]],null,R?[R[2*j],R[2*j+1],0]:S),U);else for(d=m.length/3;B<d;B+=3)T=(N=B)+1,j=B+2,Z(E,new M([m[3*N],m[3*N+1],m[3*N+2]],null,R?[R[2*N],R[2*N+1],0]:S),new M([m[3*T],m[3*T+1],m[3*T+2]],null,R?[R[2*T],R[2*T+1],0]:S),new M([m[3*j],m[3*j+1],m[3*j+2]],null,R?[R[2*j],R[2*j+1],0]:S),U);return E}(U,F[U].vs,F[U].tuv);d=d?d.concat(U):U}),d=a.$15n(d),R.forEach(function(U){var m=U.s("attach.operation");d[m]&&(d=d[m](function(U,m,R){var A,d=z(U),N=[],T=(U.appendAnchorMatrix3d(d),m?m.getData3dUI(U):null);if(T&&T.s("shape3d")&&!T.s("csg.cull.box")&&(A=T.shapeModel,A=T.shapeModel?A:V.getShapeModel(T,T.s("shape3d"))))for(var j=V.createNormalMatrix(d),B=0,E=BV.length;B<E;B++){var F=(P=BV[B]).length?P+"_":P,W=A[F+"vs"],u=A[F+"uv"],h=A[F+"is"],w=A[F+"ns"];if(W&&W.length)for(var k,C,X,c=0,f=h?h.length:W.length/3;c<f;c+=3)X=h?(k=h[c],C=h[c+1],h[c+2]):(C=(k=c)+1,c+2),Z(N,new M(H([W[3*k],W[3*k+1],W[3*k+2]],d),w?H([w[3*k],w[3*k+1],w[3*k+2]],j):null,[u[2*k],u[2*k+1],0]),new M(H([W[3*C],W[3*C+1],W[3*C+2]],d),w?H([w[3*C],w[3*C+1],w[3*C+2]],j):null,[u[2*C],u[2*C+1],0]),new M(H([W[3*X],W[3*X+1],W[3*X+2]],d),w?H([w[3*X],w[3*X+1],w[3*X+2]],j):null,[u[2*X],u[2*X+1],0]),U)}if(!A)for(B=0;B<6;B++)for(var P=r[B],e=FV[B],u=R?m.getFaceUv(U,P):S,D=R?m.getFaceUvScale(U,P):S,o=R?m.getFaceUvOffset(U,P):S,q=0;q<2;q++){var b,l,_,t=J[e+3*q],G=J[e+3*q+1],K=J[e+3*q+2];R&&(_=u?(b=[u[2*t-(_=8*B)],u[2*t+1-_],0],l=[u[2*G-_],u[2*G+1-_],0],[u[2*K-_],u[2*K+1-_],0]):(b=[O[2*t],O[2*t+1],0],l=[O[2*G],O[2*G+1],0],[O[2*K],O[2*K+1],0]),D&&(b[0]*=D[0],b[1]*=D[1],l[0]*=D[0],l[1]*=D[1],_[0]*=D[0],_[1]*=D[1]),o&&(b[0]+=o[0],b[1]+=o[1],l[0]+=o[0],l[1]+=o[1],_[0]+=o[0],_[1]+=o[1])),Z(N,new M(H([Y[3*t],Y[3*t+1],Y[3*t+2]],d),null,b),new M(H([Y[3*G],Y[3*G+1],Y[3*G+2]],d),null,l),new M(H([Y[3*K],Y[3*K+1],Y[3*K+2]],d),null,_),U)}return a.$15n(N)}(U,F.gv,F.csg.tuv)))}),r.forEach(function(U){(U=F[U]).vs=[],U.ns=[],U.tuv&&(U.tuv=[])}),F.csg&&!F.csg.ns&&(F.csg.ns=[]);var d,W=[];if(d.$19n().forEach(function(U){var m,R=U.$10n;if(R instanceof q){if(R.s("attach.cull"))return;m=(m=R.s("csg.cull.color"))&&V.toColorArray(m),R="csg"}for(var R=F[R],A=R.vs,d=R.ns,N=R.tuv,T=U.$9n,j=2;j<T.length;j++)if(u(A,T[0].$24n),u(A,T[j-1].$24n),u(A,T[j].$24n),d&&(u(d,T[0].$22n),u(d,T[j-1].$22n),u(d,T[j].$22n)),N&&(u(N,T[0].uv,!0),u(N,T[j-1].uv,!0),u(N,T[j].uv,!0)),m)for(var B=A.length/3*4,E=0;E<3;E++)W[--B]=m[3],W[--B]=m[2],W[--B]=m[1],W[--B]=m[0]}),W.length){for(var N=V.toColorArray(F.csg.color),T=0,j=F.csg.vs.length/3*4;T<j;T+=4)W[T]==E&&(W[T]=N[0],W[T+1]=N[1],W[T+2]=N[2],W[T+3]=N[3]);F.csg.cs=W}}EV.forEach(function(U){var m=F[U];m.visible&&m.vs.length?(m.ns&&m.ns.length?h(m,"ns"):m.ns=p(m.vs),h(m,"vs"),h(m,"tuv"),m.cs&&h(m,"cs")):delete F[U]}),U&&(I(F,S,U,S,m),F.clear())}function A(U,m){this.$22n=U,this.w=m}function _(U,m,R,A,u){var d=[],N=[],T=[],j=new f;if((U=U.getData3dUI(m)).mat){var B,F=(new P).fromArray(U.mat),m=new P,W=(m.makeRotationFromEuler(A),m.setPosition(R),(new P).getInverse(m)),E=(new P).scale({x:1/u.x,y:1/u.y,z:1/u.z}),h=[],w=new f,k=new f;for(U.eachShapeModel(function(U,m,R,A,d){for(var N,T,j,B=0,E=m?m.length:U.length/3;B<E;B++)m?(w.fromArray(U,3*m[B]),k.fromArray(R,3*m[B])):(w.fromArray(U,3*B),k.fromArray(R,3*B)),d&&(w.applyMatrix4(d),k.transformDirection(d)),N=h,j=k,(T=w).applyMatrix4(F),T.applyMatrix4(W),j.transformDirection(F),j.transformDirection(W),N.push(new XV(T.clone(),j.clone()))}),h=X(h,j.set(1,0,0)),h=X(h,j.set(-1,0,0)),h=X(h,j.set(0,1,0)),h=X(h,j.set(0,-1,0)),h=X(h,j.set(0,0,1)),h=X(h,j.set(0,0,-1)),B=0;B<h.length;B++){var C=h[B];T.push(.5+C.position.x/u.x,.5-C.position.y/u.y),C.position.applyMatrix4(E),d.push(C.position.x,C.position.y,C.position.z),N.push(C.$22n.x,C.$22n.y,C.$22n.z)}return{vs:d,ns:N,uv:T}}function X(U,m){for(var R=[],A=.5*Math.abs(u.dot(m)),d=0;d<U.length;d+=3){var N,T,j,B,E=0<U[d+0].position.dot(m)-A,F=0<U[d+1].position.dot(m)-A,W=0<U[d+2].position.dot(m)-A;switch((E?1:0)+(F?1:0)+(W?1:0)){case 0:R.push(U[d]),R.push(U[d+1]),R.push(U[d+2]);break;case 1:if(E&&(N=U[d+1],T=U[d+2],j=c(U[d],N,m,A),B=c(U[d],T,m,A)),F){N=U[d],T=U[d+2],j=c(U[d+1],N,m,A),B=c(U[d+1],T,m,A),R.push(j),R.push(T.clone()),R.push(N.clone()),R.push(T.clone()),R.push(j.clone()),R.push(B);break}W&&(N=U[d],T=U[d+1],j=c(U[d+2],N,m,A),B=c(U[d+2],T,m,A)),R.push(N.clone()),R.push(T.clone()),R.push(j),R.push(B),R.push(j.clone()),R.push(T.clone());break;case 2:E||(T=c(N=U[d].clone(),U[d+1],m,A),j=c(N,U[d+2],m,A),R.push(N),R.push(T),R.push(j)),F||(T=c(N=U[d+1].clone(),U[d+2],m,A),j=c(N,U[d],m,A),R.push(N),R.push(T),R.push(j)),W||(T=c(N=U[d+2].clone(),U[d],m,A),j=c(N,U[d+1],m,A),R.push(N),R.push(T),R.push(j))}}return R}function c(U,m,R,A){var d=U.position.dot(R)-A,d=d/(d-(m.position.dot(R)-A));return new XV(new f(U.position.x+d*(m.position.x-U.position.x),U.position.y+d*(m.position.y-U.position.y),U.position.z+d*(m.position.z-U.position.z)),new f(U.$22n.x+d*(m.$22n.x-U.$22n.x),U.$22n.y+d*(m.$22n.y-U.$22n.y),U.$22n.z+d*(m.$22n.z-U.$22n.z)))}}var T,j,B,F=U.ht,S=null,U=Math,C=U.PI,t=U.cos,X=U.sin,G=U.abs,K=U.max,i=U.sqrt,x=1e-5,N=F.Default,n=N.def,Q=N.startAnim,g=N.createMatrix,H=N.transformVec,V=N.getInternal(),R=V.addMethod,d=V.superCall,s=V.toPointsArray,p=V.createNormals,h=V.toFloatArray,L=V.glMV,U=(V.glPop,F.graph3d.Graph3dView,F.Math),f=U.Vector3,P=U.Matrix4,v=U.Euler,I=(U.Quaternion,V.batchShape),z=V.createNodeMatrix,y=V.getFaceInfo,$=V.transformAppend,UV=V.drawFaceInfo,mV=V.createAnim,U=V.cube(),J=U.is,Y=U.vs,O=U.uv,U=V.ui(),RV=F.Node,AV=F.Shape,dV="left",NV="right",TV="top",jV="bottom",W="dw.expanded",w=".expanded",k="dw.angle",c=".angle",Z=(T=new F.Math.Vector3,j=new F.Math.Vector3,B=new F.Math.Vector3,function(U,m,R,A,d){var N;T.copy(m.$24n),j.copy(R.$24n),B.copy(A.$24n),B.equals(T)||j.equals(T)||j.equals(B)||(m.$22n&&R.$22n&&A.$22n||(N=j.sub(T).cross(B.sub(T)).normalize().multiplyScalar(1).toArray(),m.$22n||(m.$22n=new e(N)),R.$22n||(R.$22n=new e(N)),A.$22n||(A.$22n=new e(N))),U.push(new D([m,R,A],d)))}),r=[dV,"front",NV,"back",TV,jV],BV=["",TV,jV],EV=r.concat("csg"),FV=[0,6,12,18,24,30],a=(R(N,{createFrameModel:function(U,m,R,A){U=U==S?.07:U,m=m==S?U:m,R=R==S?U:R;var d=(A=A||{}).top,N=A.bottom,T=A.left,j=A.right,B=A.front,A=A.back,E=[],F=[];return!0===B?(E.push(-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5),F.push(0,0,0,1,1,1,1,1,1,0,0,0)):!1!==B&&(E.push(-.5,.5,.5,-.5,-.5,.5,-.5+U,-.5,.5,-.5+U,-.5,.5,-.5+U,.5,.5,-.5,.5,.5,.5-U,.5,.5,.5-U,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5-U,.5,.5,-.5+U,.5,.5,-.5+U,.5-m,.5,.5-U,.5-m,.5,.5-U,.5-m,.5,.5-U,.5,.5,-.5+U,.5,.5,-.5+U,-.5+m,.5,-.5+U,-.5,.5,.5-U,-.5,.5,.5-U,-.5,.5,.5-U,-.5+m,.5,-.5+U,-.5+m,.5),F.push(0,0,0,1,U,1,U,1,U,0,0,0,1-U,0,1-U,1,1,1,1,1,1,0,1-U,0,U,0,U,m,1-U,m,1-U,m,1-U,0,U,0,U,1-m,U,1,1-U,1,1-U,1,1-U,1-m,U,1-m)),!0===A?(E.push(-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5),F.push(1,0,0,1,1,1,0,1,1,0,0,0)):!1!==A&&(E.push(-.5,.5,-.5,-.5+U,-.5,-.5,-.5,-.5,-.5,-.5+U,-.5,-.5,-.5,.5,-.5,-.5+U,.5,-.5,.5-U,.5,-.5,.5,-.5,-.5,.5-U,-.5,-.5,.5,-.5,-.5,.5-U,.5,-.5,.5,.5,-.5,-.5+U,.5,-.5,.5-U,.5-m,-.5,-.5+U,.5-m,-.5,.5-U,.5-m,-.5,-.5+U,.5,-.5,.5-U,.5,-.5,-.5+U,-.5+m,-.5,.5-U,-.5,-.5,-.5+U,-.5,-.5,.5-U,-.5,-.5,-.5+U,-.5+m,-.5,.5-U,-.5+m,-.5),F.push(1,0,1-U,1,1,1,1-U,1,1,0,1-U,0,U,0,0,1,U,1,0,1,U,0,0,0,1-U,0,U,m,1-U,m,U,m,1-U,0,U,0,1-U,1-m,U,1,1-U,1,U,1,1-U,1-m,U,1-m)),!0===T?(E.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5),F.push(0,0,0,1,1,1,1,1,1,0,0,0)):!1!==T&&(E.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5+R,-.5,-.5,-.5+R,-.5,.5,-.5+R,-.5,.5,-.5,-.5,.5,.5-R,-.5,-.5,.5-R,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5-R,-.5,.5,-.5+R,-.5,.5-m,-.5+R,-.5,.5-m,.5-R,-.5,.5-m,.5-R,-.5,.5,.5-R,-.5,.5,-.5+R,-.5,-.5+m,-.5+R,-.5,-.5,-.5+R,-.5,-.5,.5-R,-.5,-.5,.5-R,-.5,-.5+m,.5-R,-.5,-.5+m,-.5+R),F.push(0,0,0,1,R,1,R,1,R,0,0,0,1-R,0,1-R,1,1,1,1,1,1,0,1-R,0,R,0,R,m,1-R,m,1-R,m,1-R,0,R,0,R,1-m,R,1,1-R,1,1-R,1,1-R,1-m,R,1-m)),!0===j?(E.push(.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5),F.push(1,0,0,1,1,1,0,1,1,0,0,0)):!1!==j&&(E.push(.5,.5,-.5,.5,-.5,-.5+R,.5,-.5,-.5,.5,-.5,-.5+R,.5,.5,-.5,.5,.5,-.5+R,.5,.5,.5-R,.5,-.5,.5,.5,-.5,.5-R,.5,-.5,.5,.5,.5,.5-R,.5,.5,.5,.5,.5,-.5+R,.5,.5-m,.5-R,.5,.5-m,-.5+R,.5,.5-m,.5-R,.5,.5,-.5+R,.5,.5,.5-R,.5,-.5+m,-.5+R,.5,-.5,.5-R,.5,-.5,-.5+R,.5,-.5,.5-R,.5,-.5+m,-.5+R,.5,-.5+m,.5-R),F.push(1,0,1-R,1,1,1,1-R,1,1,0,1-R,0,R,0,0,1,R,1,0,1,R,0,0,0,1-R,0,R,m,1-R,m,R,m,1-R,0,R,0,1-R,1-m,R,1,1-R,1,R,1,1-R,1-m,R,1-m)),!0===d?(E.push(.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5),F.push(1,1,1,0,0,0,0,0,0,1,1,1)):!1!==d&&(E.push(.5,.5,.5,.5,.5,-.5,.5-U,.5,-.5,.5-U,.5,-.5,.5-U,.5,.5,.5,.5,.5,-.5+U,.5,.5,-.5+U,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5+U,.5,.5,.5-U,.5,.5,.5-U,.5,.5-R,-.5+U,.5,.5-R,-.5+U,.5,.5-R,-.5+U,.5,.5,.5-U,.5,.5,.5-U,.5,-.5+R,.5-U,.5,-.5,-.5+U,.5,-.5,-.5+U,.5,-.5,-.5+U,.5,-.5+R,.5-U,.5,-.5+R),F.push(1,1,1,0,1-U,0,1-U,0,1-U,1,1,1,U,1,U,0,0,0,0,0,0,1,U,1,1-U,1,1-U,1-R,U,1-R,U,1-R,U,1,1-U,1,1-U,R,1-U,0,U,0,U,0,U,R,1-U,R)),!0===N?(E.push(.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5),F.push(1,0,0,1,1,1,0,1,1,0,0,0)):!1!==N&&(E.push(.5,-.5,.5,.5-U,-.5,-.5,.5,-.5,-.5,.5-U,-.5,-.5,.5,-.5,.5,.5-U,-.5,.5,-.5+U,-.5,.5,-.5,-.5,-.5,-.5+U,-.5,-.5,-.5,-.5,-.5,-.5+U,-.5,.5,-.5,-.5,.5,.5-U,-.5,.5,-.5+U,-.5,.5-R,.5-U,-.5,.5-R,-.5+U,-.5,.5-R,.5-U,-.5,.5,-.5+U,-.5,.5,.5-U,-.5,-.5+R,-.5+U,-.5,-.5,.5-U,-.5,-.5,-.5+U,-.5,-.5,.5-U,-.5,-.5+R,-.5+U,-.5,-.5+R),F.push(1,0,1-U,1,1,1,1-U,1,1,0,1-U,0,U,0,0,1,U,1,0,1,U,0,0,0,1-U,0,U,R,1-U,R,U,R,1-U,0,U,0,1-U,1-R,U,1,1-U,1,U,1,1-U,1-R,U,1-R)),{vs:E,uv:F}}}),R(F.Style,{"csg.cull.color":E,"csg.cull.box":!0,"dw.flip":!1,"dw.s3":[.999,.999,.5],"dw.t3":E,"dw.expanded":!1,"dw.toggleable":!0,"dw.axis":"left","dw.start":0,"dw.end":C/2,"dw.angle":0,"attach.cull":!1,"attach.operation":"subtract"},!0),r.forEach(function(U){var m={};m[U+w]=!1,m[U+".toggleable"]=!1,m[U+".axis"]=dV,m[U+".start"]=0,m[U+".end"]=C/2,m[U+c]=0,R(F.Style,m,!0)}),function(){this.$4n=[]}),e=(a.$15n=function(U){var m=new a;return m.$4n=U,m},a.prototype={clone:function(){var U=new a;return U.$4n=this.$4n.map(function(U){return U.clone()}),U},$19n:function(){return this.$4n},union:function(U){var m=new o(this.clone().$4n),U=new o(U.clone().$4n);return m.$3n(U),U.$3n(m),U.$6n(),U.$3n(m),U.$6n(),m.$7n(U.$2n()),a.$15n(m.$2n())},subtract:function(U){var m=new o(this.clone().$4n),U=new o(U.clone().$4n);return m.$6n(),m.$3n(U),U.$3n(m),U.$6n(),U.$3n(m),U.$6n(),m.$7n(U.$2n()),m.$6n(),a.$15n(m.$2n())},intersect:function(U){var m=new o(this.clone().$4n),U=new o(U.clone().$4n);return m.$6n(),U.$3n(m),U.$6n(),m.$3n(U),U.$3n(m),m.$7n(U.$2n()),m.$6n(),a.$15n(m.$2n())},inverse:function(){var U=this.clone();return U.$4n.map(function(U){U.flip()}),U}},a.cube=function(U){var R=new e((U=U||{}).center||[0,0,0]),A=U.radius?U.radius.length?U.radius:[U.radius,U.radius,U.radius]:[1,1,1];return a.$15n([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(m){return new D(m[0].map(function(U){U=new e(R.x+A[0]*(2*!!(1&U)-1),R.y+A[1]*(2*!!(2&U)-1),R.z+A[2]*(2*!!(4&U)-1));return new M(U,new e(m[1]))}))}))},a.sphere=function(U){var R,A=new e((U=U||{}).center||[0,0,0]),d=U.radius||1,m=U.slices||16,N=U.stacks||8,T=[];function j(U,m){m*=C;U=new e(t(U*=2*C)*X(m),t(m),X(U)*X(m));R.push(new M(A.$20n(U.$21n(d)),U))}for(var B=0;B<m;B++)for(var E=0;E<N;E++)R=[],j(B/m,E/N),0<E&&j((B+1)/m,E/N),E<N-1&&j((B+1)/m,(E+1)/N),j(B/m,(E+1)/N),T.push(new D(R));return a.$15n(T)},a.cylinder=function(U){var A=new e((U=U||{}).start||[0,-1,0]),m=new e(U.end||[0,1,0]),d=m.$13n(A),N=U.radius||1,R=U.slices||16,T=d.$14n(),U=.5<G(T.y),j=new e(U,!U,0).cross(T).$14n(),B=j.cross(T).$14n(),E=new M(A,T.$11n()),F=new M(m,T.$14n()),W=[];function u(U,m,R){m=m*C*2,m=j.$21n(t(m)).$20n(B.$21n(X(m))),U=A.$20n(d.$21n(U)).$20n(m.$21n(N)),m=m.$21n(1-G(R)).$20n(T.$21n(R));return new M(U,m)}for(var h=0;h<R;h++){var w=h/R,k=(h+1)/R;W.push(new D([E,u(0,w,-1),u(0,k,-1)])),W.push(new D([u(0,k,0),u(0,w,0),u(1,w,0),u(1,k,0)])),W.push(new D([F,u(1,k,1),u(1,w,1)]))}return a.$15n(W)},function(U,m,R){var A=this;3==arguments.length?(A.x=U,A.y=m,A.z=R):"x"in U?(A.x=U.x,A.y=U.y,A.z=U.z):(A.x=U[0],A.y=U[1],A.z=U[2])}),M=(e.prototype={clone:function(){return new e(this.x,this.y,this.z)},$11n:function(){return new e(-this.x,-this.y,-this.z)},$20n:function(U){return new e(this.x+U.x,this.y+U.y,this.z+U.z)},$13n:function(U){return new e(this.x-U.x,this.y-U.y,this.z-U.z)},$21n:function(U){return new e(this.x*U,this.y*U,this.z*U)},$16n:function(U){return new e(this.x/U,this.y/U,this.z/U)},dot:function(U){return this.x*U.x+this.y*U.y+this.z*U.z},lerp:function(U,m){return this.$20n(U.$13n(this).$21n(m))},length:function(){return i(this.dot(this))},$14n:function(){return this.$16n(this.length())},cross:function(U){var m=this;return new e(m.y*U.z-m.z*U.y,m.z*U.x-m.x*U.z,m.x*U.y-m.y*U.x)}},function(U,m,R){this.$24n=new e(U),this.$22n=m?new e(m):null,this.uv=R?new e(R):null}),D=(M.prototype={clone:function(){return new M(this.$24n.clone(),this.$22n.clone(),this.uv?this.uv.clone():null)},flip:function(){this.$22n=this.$22n.$11n()},$18n:function(U,m){return new M(this.$24n.lerp(U.$24n,m),this.$22n.lerp(U.$22n,m),this.uv?this.uv.lerp(U.uv,m):null)}},A.$17n=function(U,m,R){m=m.$13n(U).cross(R.$13n(U)).$14n();return new A(m,m.dot(U))},A.prototype={clone:function(){return new A(this.$22n.clone(),this.w)},flip:function(){this.$22n=this.$22n.$11n(),this.w=-this.w},$5n:function(U,m,R,A,d){for(var N=this,T=0,j=[],B=0;B<U.$9n.length;B++){var E=(u=N.$22n.dot(U.$9n[B].$24n)-N.w)<-x?2:x<u?1:0;T|=E,j.push(E)}switch(T){case 0:(0<N.$22n.dot(U.$8n.$22n)?m:R).push(U);break;case 1:A.push(U);break;case 2:d.push(U);break;case 3:for(var F=[],W=[],B=0;B<U.$9n.length;B++){var u,h=(B+1)%U.$9n.length,w=j[B],k=j[h],C=U.$9n[B],h=U.$9n[h];2!=w&&F.push(C),1!=w&&W.push(2!=w?C.clone():C),3==(w|k)&&(u=(N.w-this.$22n.dot(C.$24n))/N.$22n.dot(h.$24n.$13n(C.$24n)),w=C.$18n(h,u),F.push(w),W.push(w.clone()))}3<=F.length&&A.push(new D(F,U.$10n)),3<=W.length&&d.push(new D(W,U.$10n))}}},function(U,m){this.$9n=U,this.$10n=m,this.$8n=A.$17n(U[0].$24n,U[1].$24n,U[2].$24n)}),o=(D.prototype={clone:function(){var U=this.$9n.map(function(U){return U.clone()});return new D(U,this.$10n)},flip:function(){this.$9n.reverse().map(function(U){U.flip()}),this.$8n.flip()}},function(U){var m=this;m.$8n=null,m.front=null,m.back=null,m.$4n=[],U&&m.$7n(U)}),WV=(o.prototype={clone:function(){var U=this,m=new o;return m.$8n=U.$8n&&U.$8n.clone(),m.front=U.front&&U.front.clone(),m.back=U.back&&U.back.clone(),m.$4n=U.$4n.map(function(U){return U.clone()}),m},$6n:function(){for(var U=this,m=0;m<U.$4n.length;m++)U.$4n[m].flip();U.$8n&&U.$8n.flip(),U.front&&U.front.$6n(),U.back&&U.back.$6n();var R=U.front;U.front=U.back,U.back=R},$1n:function(U){var m=this;if(!m.$8n)return U.slice();for(var R=[],A=[],d=0;d<U.length;d++)m.$8n.$5n(U[d],R,A,R,A);return m.front&&(R=m.front.$1n(R)),A=m.back?m.back.$1n(A):[],R.concat(A)},$3n:function(U){var m=this;m.$4n=U.$1n(m.$4n),m.front&&m.front.$3n(U),m.back&&m.back.$3n(U)},$2n:function(){var U=this,m=U.$4n.slice();return U.front&&(m=m.concat(U.front.$2n())),m=U.back?m.concat(U.back.$2n()):m},$7n:function(U){var m=this;if(U.length){m.$8n||(m.$8n=U[0].$8n.clone());for(var R=[],A=[],d=0;d<U.length;d++)this.$8n.$5n(U[d],m.$4n,m.$4n,R,A);R.length&&(m.front||(m.front=new o),this.front.$7n(R)),A.length&&(m.back||(m.back=new o),m.back.$7n(A))}}},F.Symbol=function(U,m,R){d(WV,this),this.s3(20,20,20),this.s({"all.visible":!1,shape:"rect"}),this.setIcon(U,m,R)}),q=(m("Symbol",RV,{setIcon:function(U,m,R){var A,d=this;return WV.superClass.setIcon.call(d,U),U?(A={for3d:!0,face:"center",position:44,names:[U]},R&&(A.transaprent=!0),m&&(A.autorotate=m),d.addStyleIcon("symbol",A)):d.removeStyleIcon("symbol"),d.setWidth(V.getImageWidth(N.getImage(U),d)||20),A}}),F.CSGNode=function(){d(q,this),this.s({shape:"rect","attach.thickness":1.001,"2d.attachable":!0})}),uV={position:1,width:1,height:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,tall:1,elevation:1,anchor:1,anchorElevation:1,"s:attach.cull":1,"s:attach.operation":1},b=(m("CSGNode",RV,{get3dUIClass:function(){return b},onPropertyChanged:function(U){var m=this.getHost();q.superClass.onPropertyChanged.call(this,U),uV[U.property]&&(m instanceof hV||m instanceof q)&&m.fp("csgNodeChange",!0,!1)}}),function(U,m){d(b,this,[U,m])}),hV=(n(b,U.Node3dUI,{drawBody:function(m,R,A){var d=this;d._shape3d?b.superClass.drawBody.call(d,m,R,A):(L(d.gv),EV.forEach(function(U){UV(d,m,R,U,A)}))},validate:function(U,m){var R=this,A=R.gv,d=R.data;if(d.s("shape3d"))return b.superClass.validate.call(R,U,m),void(R._shape3d=!0);R._shape3d=!1;var N=z(d,A.getMat(d)),T=(d.appendAnchorMatrix3d(N),U&&U.uv);R.vf2("csg",T);for(var j=0;j<6;j++)for(var B=r[j],E=FV[j],B=R.vf2(B,T,m),F=B.mat||N,W=B.vs,u=B.uv,h=B.tuv,w=0;w<2;w++){var k,C=J[E+3*w],X=J[E+3*w+1],c=J[E+3*w+2];$(W,F,[Y[3*C],Y[3*C+1],Y[3*C+2]]),$(W,F,[Y[3*X],Y[3*X+1],Y[3*X+2]]),$(W,F,[Y[3*c],Y[3*c+1],Y[3*c+2]]),h&&(u?h.push(u[2*C-(k=8*j)],u[2*C+1-k],u[2*X-k],u[2*X+1-k],u[2*c-k],u[2*c+1-k]):h.push(O[2*C],O[2*C+1],O[2*X],O[2*X+1],O[2*c],O[2*c+1]))}l(R,U,m)},vf2:function(U,m,R){var A=this.gv.getFaceVisible(this.data,U),U=y(this,U,R);return U.vs=[],U.tuv=A&&(U.texture||m)?[]:S,U.visible=A,U}}),F.CSGShape=function(){var U=this;d(hV,U),U.s({"shape.background":S,"2d.hostable":!0,"shape.border.width":8}),U.setTall(240),U.setElevation(120),U.setThickness(14)}),wV=(m("CSGShape",AV,{IRotatable:!1,get3dUIClass:function(){return wV},setRotationX:function(U){},setRotation:function(U){},setRotationZ:function(U){},setSegments:function(U){}}),function(U,m){d(wV,this,[U,m])}),kV=(n(wV,U.Shape3dUI,{drawBody:function(m,R,A){var d=this;d.undrawable||(L(d.gv),EV.forEach(function(U){UV(d,m,R,U,A)}))},validate:function(m,R){var U,A,d,N,T=this,j=T.data,B=j.getPoints();(T.undrawable=B.size()<2)?T.clear():(U=j.isClosePath(),A=K(j._thickness/2,x),B=s(B,S,S,U),EV.forEach(function(U){T.vf(U,m&&m.uv,!0,R)}),U&&(T.left.visible=!1,T.right.visible=!1),T._12O(B,A),T._20Q(B),d=j.getPointsMatrix3d(),N=F.Math.requestVector3(),r.forEach(function(U){if(T[U])for(var m=T[U].vs,R=0,A=m.length;R<A;R+=3)N.set(m[R],m[R+1],m[R+2]).applyMatrix4(d),m[R]=N.x,m[R+1]=N.y,m[R+2]=N.z}),F.Math.releaseVector3(N),l(T,m,R))}}),F.DoorWindow=function(){d(kV,this),this.setElevation(100),this.s3(100,200,14)}),CV=(m("DoorWindow",q,{IDoorWindow:!0,toggle:function(U){this.setExpanded(!this.s(W),U)},isExpanded:function(){return this.s(W)},setExpanded:function(U,m){var R,A=this,d=A.$25n,N=A.s(W);d&&(d.stop(!0),delete A.$25n),N!==U&&(A.beginTransaction(),R=U?A.s("dw.end"):A.s("dw.start"),A.s(W,U),(m=mV(m))?(N=A.s(k),m.action=function(U){A.s(k,N+(R-N)*U)},m.finishFunc=function(){A.endTransaction()},A.$25n=Q(m)):(A.s(k,R),A.endTransaction()))},getMat:function(){var U,m,R=this,A=R.s("dw.s3"),d=R.s("dw.t3"),N=R.s("dw.flip"),T=R.s(k);return A||T||d||N?(U=[],N&&U.push({r3:[0,C,0]}),A&&U.push({s3:A}),T&&(A=R.getFinalScale3d(),N=R.s("dw.axis"),R=A[0]/2,m=A[1]/2,A[2],N===dV?U.push({t3:[R,0,0]},{r3:[0,-T,0]},{t3:[-R,0,0]}):N===NV?U.push({t3:[-R,0,0]},{r3:[0,T,0]},{t3:[R,0,0]}):N===TV?U.push({t3:[0,-m,0]},{r3:[-T,0,0]},{t3:[0,m,0]}):N===jV?U.push({t3:[0,m,0]},{r3:[T,0,0]},{t3:[0,-m,0]}):"v"===N?U.push({r3:[0,T,0]}):"h"===N&&U.push({r3:[T,0,0]})),d&&U.push({t3:d}),g(U)):S}}),F.CSGBox=function(){d(CV,this),this.setElevation(100),this.s3(100,200,100)});m("CSGBox",q,{ICSGBox:!0,toggleFace:function(U,m){this.setFaceExpanded(U,!this.s(U+w),m)},isFaceExpanded:function(U){return this.s(U+w)},setFaceExpanded:function(m,U,R){var A,d=this,N=d.$25n,T=d.s(m+w);N&&(N.stop(!0),delete d.$25n),T!==U&&(A=U?d.s(m+".end"):d.s(m+".start"),d.s(m+w,U),(R=mV(R))?(T=d.s(m+c),R.action=function(U){d.s(m+c,T+(A-T)*U)},d.$25n=Q(R)):d.s(m+c,A))},getFaceMat:function(U){var m=this.s(U+c);if(!m)return S;var R,A,d,N,T,j,B=this.s(U+".axis"),E=this.getFinalScale3d(),F=this.getAnchor3d(),W=E[0]*F.x,u=E[1]*F.y,h=E[2]*F.z,w=E[0]-W,k=E[1]-u,C=E[2]-h;switch(U+"_"+B){case"front_left":R=-W,d=C,T=-m,j=N=A=0;break;case"front_right":R=w,d=C,T=m,j=N=A=0;break;case"front_top":A=k,d=C,N=-m,j=T=R=0;break;case"front_bottom":A=-u,d=C,N=m,j=T=R=0;break;case"front_h":d=C,N=m,j=T=A=R=0;break;case"front_v":d=C,T=m,j=N=A=R=0;break;case"back_left":R=w,d=-h,T=-m,j=N=A=0;break;case"back_right":R=-W,d=-h,T=m,j=N=A=0;break;case"back_top":A=k,d=-h,N=m,j=T=R=0;break;case"back_bottom":A=-u,d=-h,N=-m,j=T=R=0;break;case"back_h":d=-h,N=m,j=T=A=R=0;break;case"back_v":d=-h,T=m,j=N=A=R=0;break;case"left_left":R=-W,d=-h,T=-m,j=N=A=0;break;case"left_right":R=-W,d=C,T=m,j=N=A=0;break;case"left_top":R=-W,A=k,T=N=d=0,j=-m;break;case"left_bottom":R=-W,A=-u,T=N=d=0,j=m;break;case"left_h":R=-W,T=N=d=A=0,j=m;break;case"left_v":R=-W,T=m,j=N=d=A=0;break;case"right_left":R=w,d=C,T=-m,j=N=A=0;break;case"right_right":R=w,d=-h,T=m,j=N=A=0;break;case"right_top":R=w,A=k,T=N=d=0,j=m;break;case"right_bottom":R=w,A=-u,T=N=d=0,j=-m;break;case"right_h":R=w,T=N=d=A=0,j=m;break;case"right_v":R=w,T=m,j=N=d=A=0;break;case"top_left":R=-W,A=k,T=N=d=0,j=m;break;case"top_right":R=w,A=k,T=N=d=0,j=-m;break;case"top_top":A=k,d=-h,N=-m,j=T=R=0;break;case"top_bottom":A=k,d=C,N=m,j=T=R=0;break;case"top_h":A=k,N=m,j=T=d=R=0;break;case"top_v":A=k,T=N=d=R=0,j=m;break;case"bottom_left":R=-W,A=-u,T=N=d=0,j=-m;break;case"bottom_right":R=w,A=-u,T=N=d=0,j=m;break;case"bottom_top":A=-u,d=C,N=-m,j=T=R=0;break;case"bottom_bottom":A=-u,d=-h,N=m,j=T=R=0;break;case"bottom_h":A=-u,N=m,j=T=d=R=0;break;case"bottom_v":A=-u,T=N=d=R=0,j=m}return g([{t3:[-R,-A,-d]},{r3:[N,T,j]},{t3:[R,A,d]}])}});function XV(U,m){this.position=U,this.$22n=m}XV.prototype.clone=function(){return new XV(this.position.clone(),this.$22n.clone())};R(F.graph3d.Graph3dView,{createDecal:function(U,m,R,A){var d=this,N=d.getDataAt(U);if(N){var T,j,B,U=d.intersectObject(U,N);if(U)return m="object"==typeof m?m.x?new f(m.x,m.y,m.z):new f(m[0],m[1],m[2]):new f(m=m||20,m,m),R=R===E?.1:R,B=new f(d.getUp()),T=(j=new f(d.getCenter()).sub(new f(d.getEye())).normalize()).clone().cross(B).normalize(),B.copy(T).cross(j).normalize(),A&&B.applyAxisAngle(U.worldNormal,-A),T=new F.Node,j=U.worldNormal.clone().setLength(R).add(U.world),A=(new P).lookAt(U.worldNormal.clone(),new f(0,0,0),B),R=(new v).setFromRotationMatrix(A),B=_(d,N,U.world.clone(),R,m),T.p3(j.x,j.y,j.z),T.setEuler(R),T.s3(m.x,m.y,m.z),T.s({shape3d:B,"shape3d.reverse.flip":!0}),T}}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),void Object);